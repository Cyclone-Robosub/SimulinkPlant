if(~exist('prj_path_list','var')) %refreshes the file path in case clear all was called
    prj_path_list = getProjectPaths();
end

A_lqr = load(fullfile(prj_path_list.lqr_lookup_path,"lqr_A"),"lqr_A");
B_lqr = load(fullfile(prj_path_list.lqr_lookup_path,"lqr_B"),"lqr_B");

qref = [1 0 0 0]'; %reference quaternion
vref = [0 0 0]'; %reference velocity
wref = [0 0 0]';

A = A_lqr.lqr_A(qref(1), qref(2), qref(3), qref(4), vref(1), vref(2), ...
    vref(3),wref(1), wref(2),wref(3),I(1,1), I(2,2), I(3,3), m, ...
    M_added(1,1), M_added(2,2), M_added(3,3),drag_wrench(1,1), ...
    drag_wrench(2,2), drag_wrench(3,3), drag_wrench(4,4),drag_wrench(5,5),...
    drag_wrench(6,6), R_cm2cv(1), R_cm2cv(2), R_cm2cv(3),V,g,rho);

uref = zeros(8,1);
B = B_lqr.lqr_B(NT_list(1,1),NT_list(2,1),NT_list(3,1),NT_list(1,2),...
    NT_list(2,2),NT_list(3,2),NT_list(1,3),NT_list(2,3),NT_list(3,3),...
    NT_list(1,4),NT_list(2,4),NT_list(3,4),NT_list(1,5),NT_list(2,5),...
    NT_list(3,5),NT_list(1,6),NT_list(2,6),NT_list(3,6),NT_list(1,7),...
    NT_list(2,7),NT_list(3,7),NT_list(1,8),NT_list(2,8),NT_list(3,8),...
    uref(1),uref(2),uref(3),uref(4),uref(5),uref(6),uref(7),uref(8),...
    I(1,1),I(2,2),I(3,3),m,M_added(1,1),M_added(2,2),M_added(3,3),...
    RT_list(1,1),RT_list(2,1),RT_list(3,1),RT_list(1,2),RT_list(2,2),...
    RT_list(3,2),RT_list(1,3),RT_list(2,3),RT_list(3,3),RT_list(1,4),...
    RT_list(2,4),RT_list(3,4),RT_list(1,5),RT_list(2,5),RT_list(3,5),...
    RT_list(1,6),RT_list(2,6),RT_list(3,6),RT_list(1,7),RT_list(2,7),...
    RT_list(3,7),RT_list(1,8),RT_list(2,8),RT_list(3,8));

Q = diag([0 0 0 1 1 1 1 1 1 1 1 1]);
R = diag([1 1 1 1 1 1 1 1]);

K = lqr(A,B,Q,R);